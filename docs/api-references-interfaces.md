# Интерфейсы

## Интерфейс IDataSource

Пространство имен: OpcSrv.Shared

Сборка: OpcSrv.Shared.dll

### Методы

!!!summary "C#"
    **void Initialize(string alias, Dictionary&lt;string, string&gt; args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
alias | string | Псевдоним экземпляра источника данных, указанный в файле OpcSrv.config
args | Dictionary&lt;string, string&gt; | Словарь параметров инициализации, указанный в файле OpcSrv.config

Метод инициализации источника данных. Это первый метод который вызывается у источника данных сразу после создания его объекта. Источник данных должен при необходимости загрузить свою конфигурацию и проинициализировать ардесное пространство.

---

!!!summary "C#"
    **DataSourceAddressSpace GetAddressSpace();**

Метод возвращает адресное пространство источника данных.

---

!!!summary "C#"
    **void Start();**

Запуск источника данных. В этом методе источник данных должен организовать запуск внутренних механизмов соединения с устройством, штатного опроса устройства и т.д. В любом случае, после вызова этого метода, источник данных должен начинать обновление данных в кеше и быть способным принимать со стороны OPC сервера запросы на чтение/запись данных в устройство.

---

!!!summary "C#"
    **void Stop();**

Останов источника данных. В этом методе источник данных должен остановить все внутренние механизмы работы с устройством. Этот метод вызывается при завершении работы программы.

---

!!!summary "C#"
    **ItemValue[] ReadFromDevice(string[] arrId, CancelToken cancelToken);**

Параметры:

Имя | Тип | Описание
----|-----|---------
arrId |string[] | Массив идентификаторов тегов по которым необходимо вернуть данные. Эти идентификаторы являются значениями свойства **Id** экземпляров класса **Leaf**, переданных в описании адресного пространства при вызове иметода **GetAddressSpace**
cancelToken | CancelToken | Объект сигнала отмены выполнения текущей операции

Чтение данных с устройства. Этот метод принудительно должен прочитать с устройства и вернуть значения указанных тегов. Возвращаемый массив должен содержать значения для каждого из указанных идентификаторов. Код метода должен проверять значение свойства **IsCancelRequested** объекта **cancelToken**, и если оно возвращает **true**, должен, не производя опроса, как можно быстрее завершить свое выполнение. Возвращаемое значение при отмене операции не оценивается.

---

!!!summary "C#"
    **OperationError[] WriteToDevice(string[] arrId, object[] values, CancelToken cancelToken);**

Параметры:

Имя | Тип | Описание
----|-----|---------
arrId | string[] | Массив идентификаторов тегов по которым необходимо произвести запись значений. Эти идентификаторы являются значениями свойства **Id** экземпляров класса **Leaf**, переданных в описании адресного пространства при вызове иметода **GetAddressSpace**
values | object[] | Массив записываемых значений для каждого идентификатора
cancelToken | CancelToken | Объект сигнала отмены выполнения текущей операции

Запись данных в устройство. Этот метод должен записать указанные значения в устройство и вернуть признак завершения опрерации для каждого из идентификаторов. Код метода должен проверять значение свойства **IsCancelRequested** объекта **cancelToken**, и если оно возвращает **true**, должен, не производя записи, как можно быстрее завершить свое выполнение. Возвращаемое значение при отмене операции не оценивается.

---

## Интерфейс ILogger

Пространство имен: OpcSrv.Shared.Loging

Сборка: OpcSrv.Shared.dll

### Методы

!!!summary "C#"
    **void Info(string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит информационное сообщение в журнал работы программы.

!!!summary "C#"
    **void Info(Exception exception, string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
exception|Exception|Экземпляр объекта ошибки
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит информационное сообщение в журнал работы программы.

!!!summary "C#"
    **void Info(Func&lt;string&gt; getMessage);**

Параметры:

Имя | Тип | Описание
----|-----|---------
getMessage|Func&lt;string&gt;|Делегат функции, возвращающей текст сообщения. Эта функция будет вызвана только если уровень логирования будет не меньше INFO

Выводит информационное сообщение в журнал работы программы.

!!!summary "C#"
    **void Fatal(string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение о критической ошибке в журнал работы программы.

!!!summary "C#"
    **void Fatal(Exception exception, string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
exception|Exception|Экземпляр объекта ошибки
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение о критической ошибке в журнал работы программы.

!!!summary "C#"
    **void Fatal(Func&lt;string&gt; getMessage);**

Параметры:

Имя | Тип | Описание
----|-----|---------
getMessage|Func&lt;string&gt;|Делегат функции, возвращающей текст сообщения. Эта функция будет вызвана только если уровень логирования будет не меньше FATAL

Выводит сообщение о критической ошибке в журнал работы программы.

!!!summary "C#"
    **void Error(string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение об ошибке в журнал работы программы.

!!!summary "C#"
    **void Error(Exception exception, string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
exception|Exception|Экземпляр объекта ошибки
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение об ошибке в журнал работы программы.

!!!summary "C#"
    **void Error(Func&lt;string&gt; getMessage);**

Параметры:

Имя | Тип | Описание
----|-----|---------
getMessage|Func&lt;string&gt;|Делегат функции, возвращающей текст сообщения. Эта функция будет вызвана только если уровень логирования будет не меньше ERROR

Выводит сообщение об ошибке в журнал работы программы.

!!!summary "C#"
    **void Warn(string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение о предупреждении в журнал работы программы.

!!!summary "C#"
    **void Warn(Exception exception, string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
exception|Exception|Экземпляр объекта ошибки
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит сообщение о предупреждении в журнал работы программы.

!!!summary "C#"
    **void Warn(Func&lt;string&gt; getMessage);**

Параметры:

Имя | Тип | Описание
----|-----|---------
getMessage|Func&lt;string&gt;|Делегат функции, возвращающей текст сообщения. Эта функция будет вызвана только если уровень логирования будет не меньше WARNING

Выводит сообщение о предупреждении в журнал работы программы.

!!!summary "C#"
    **void Debug(string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит отладочное сообщение в журнал работы программы.

!!!summary "C#"
    **void Debug(Exception exception, string message, params object[] args);**

Параметры:

Имя | Тип | Описание
----|-----|---------
exception|Exception|Экземпляр объекта ошибки
message|string|Формат строки сообщения
args|object[]|Необязятельные аргументы

Выводит отладочное сообщение в журнал работы программы.

!!!summary "C#"
    **void Debug(Func&lt;string&gt; getMessage);**

Параметры:

Имя | Тип | Описание
----|-----|---------
getMessage|Func&lt;string&gt;|Делегат функции, возвращающей текст сообщения. Эта функция будет вызвана только если уровень логирования будет не меньше DEBUG

Выводит отладочное сообщение в журнал работы программы.











